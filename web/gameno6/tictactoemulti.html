<script>
var board = ["","","","","","","","",""];
var gameOver = false;

function play(i) {
  if (board[i] !== "" || gameOver) return;

  // PLAYER MOVE
  board[i] = "X";
  draw();

  if (checkWin("X")) {
    document.getElementById("msg").textContent =
      "YOU OUTSMARTED THE STATE.";
    gameOver = true;
    return;
  }

  if (isDraw()) {
    document.getElementById("msg").textContent =
      "DRAW. ACCEPTABLE OUTCOME.";
    gameOver = true;
    return;
  }

  // STATE MOVE (AI)
  stateMove();
}

function stateMove() {
  var empty = [];
  for (var i = 0; i < 9; i++) {
    if (board[i] === "") empty.push(i);
  }

  if (empty.length === 0) return;

  var choice = empty[Math.floor(Math.random() * empty.length)];
  board[choice] = "O";
  draw();

  if (checkWin("O")) {
    document.getElementById("msg").textContent =
      "STATE PREVAILS.";
    gameOver = true;
    return;
  }

  if (isDraw()) {
    document.getElementById("msg").textContent =
      "DRAW. ACCEPTABLE OUTCOME.";
    gameOver = true;
  }
}

function draw() {
  var cells = document.getElementsByClassName("cell");
  for (var i = 0; i < 9; i++) {
    cells[i].textContent = board[i];
  }
}

function checkWin(p) {
  var w = [
    [0,1,2],[3,4,5],[6,7,8],
    [0,3,6],[1,4,7],[2,5,8],
    [0,4,8],[2,4,6]
  ];
  for (var i = 0; i < w.length; i++) {
    if (board[w[i][0]] === p &&
        board[w[i][1]] === p &&
        board[w[i][2]] === p)
      return true;
  }
  return false;
}

function isDraw() {
  for (var i = 0; i < 9; i++) {
    if (board[i] === "") return false;
  }
  return true;
}

function resetGame() {
  board = ["","","","","","","","",""];
  gameOver = false;
  document.getElementById("msg").textContent = "";
  draw();
}

draw();
</script>
